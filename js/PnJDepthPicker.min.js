const DEPTHPICKERCONFIGURE={noneSelectMsg:['선택사항'],selectName:['select'],};class PnJDepthPicker{constructor(target,data,noneData=1,configure={}){this.target=document.querySelector(target);this.data=data;this.selectData=[];this.noneData=noneData;this.configure={...DEPTHPICKERCONFIGURE,...configure};this.init()};init=()=>{this.createSelector(0)};createSelector=(depthNumber)=>{const depthSelector=document.createElement('select');depthSelector.classList.add('pnj-data-depth-selector');depthSelector.setAttribute('id',`pnj-data-depth-selector-${depthNumber}`);depthSelector.setAttribute('data-pnj-depth',depthNumber);depthSelector.setAttribute('name',(this.configure.selectName[depthNumber])?this.configure.selectName[depthNumber]:`${this.configure.selectName[0]}_${depthNumber}`);let data=this.data;if(depthNumber>0){for(let i=0;i<depthNumber;i++){data=(i===depthNumber-1)?this.setData(data[this.selectData[i]]):data[this.selectData[i]]}}else{data=this.setData(data)}if(data){const noneSelectMsg=(this.configure.noneSelectMsg[depthNumber])?this.configure.noneSelectMsg[depthNumber]:this.configure.noneSelectMsg[0];let setOptionHtml=(this.noneData)?`<option value="">${noneSelectMsg}</option>`:'';setOptionHtml+=data.map(v=>`<option value="${v}">${v}</option>`).join('');depthSelector.innerHTML=setOptionHtml;depthSelector.addEventListener('change',(e)=>{this.selectData[e.target.getAttribute('data-pnj-depth')]=e.target.options[e.target.selectedIndex].value;const newDepth=Number(e.target.getAttribute('data-pnj-depth'))+1;for(let i=newDepth;i<=this.selectData.length;i++){if(document.querySelector(`#pnj-data-depth-selector-${i}`)){document.querySelector(`#pnj-data-depth-selector-${i}`).remove()}}this.createSelector(newDepth)});this.target.appendChild(depthSelector);if(data.length===1||!this.noneData){this.selectData[depthSelector.getAttribute('data-pnj-depth')]=data[0];const newDepth=Number(depthSelector.getAttribute('data-pnj-depth'))+1;for(let i=newDepth;i<=this.selectData.length;i++){if(document.querySelector(`#pnj-data-depth-selector-${i}`)){document.querySelector(`#pnj-data-depth-selector-${i}`).remove()}}this.createSelector(newDepth)}}};setData=(data)=>{return(Array.isArray(data))?data:(data)?Object.keys(data):false}}